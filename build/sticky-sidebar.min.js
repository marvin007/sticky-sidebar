!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.StickySidebar=e():t.StickySidebar=e()}(window,(function(){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(n,o,function(e){return t[e]}.bind(null,o));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e);i(1);function n(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return o(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function r(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function s(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?r(Object(i),!0).forEach((function(e){u(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function l(t,e,i){return e&&a(t.prototype,e),i&&a(t,i),t}function u(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var h=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(c(this,t),u(this,"options",{}),u(this,"classPrefix","ss"),u(this,"target",null),u(this,"targetParent",null),u(this,"container",null),u(this,"sidebar",null),u(this,"currentScroll",window.pageYOffset),u(this,"scrollDirection",""),u(this,"stickyPosition",""),u(this,"eventHandlers",new Map),u(this,"resizeObserverInstances",new Map),this.options=s(s({},this.options),i),"string"==typeof e){if(this.target=document.querySelector(e),!this.target)throw new Error("sidebar element not found")}else{if(!(e instanceof HTMLElement))throw new Error("wrong sidebar element type");this.target=e}this.initialize()}return l(t,[{key:"containerClass",get:function(){return"".concat(this.classPrefix,"-container")}},{key:"sidebarClass",get:function(){return"".concat(this.classPrefix,"-sidebar")}},{key:"stickyTopClass",get:function(){return"".concat(this.classPrefix,"-sticky-top")}},{key:"stickyBottomClass",get:function(){return"".concat(this.classPrefix,"-sticky-bottom")}}]),l(t,[{key:"initialize",value:function(){this.createLayout(),this.bindMethods(),this.debounceMethods(),this.setResizeObserverInstances(),this.setEventHandlers(),this.initResizeObserverActions("add"),this.initEventActions("add"),this.update()}},{key:"destroy",value:function(){this.initEventActions("remove"),this.initResizeObserverActions("remove"),this.removeStickyPosition(),this.destroyLayout()}},{key:"createLayout",value:function(){this.targetParent=this.target.parentElement,this.sidebar=document.createElement("div"),this.sidebar.className=this.sidebarClass,this.container=document.createElement("div"),this.container.className=this.containerClass,this.sidebar.append(this.target),this.container.append(this.sidebar),this.targetParent.append(this.container)}},{key:"destroyLayout",value:function(){this.container.parentElement.append(this.target),this.container.remove()}},{key:"bindMethods",value:function(){var t=this;["windowScrollHandler","update","sidebarResizeHandler","containerResizeHandler"].forEach((function(e){t[e]=t[e].bind(t)}))}},{key:"debounceMethods",value:function(){var e=this;["windowScrollHandler","update"].forEach((function(i){e[i]=t.debounce(e[i])}))}},{key:"setEventHandlers",value:function(){var t=this;[[window,{scroll:{handler:this.windowScrollHandler},resize:{handler:this.update}}]].forEach((function(e){t.eventHandlers.set(e[0],e[1])}))}},{key:"setResizeObserverInstances",value:function(){var t=this;[[this.sidebar,new ResizeObserver(this.sidebarResizeHandler)],[this.container,new ResizeObserver(this.containerResizeHandler)]].forEach((function(e){t.resizeObserverInstances.set(e[0],e[1])}))}},{key:"initEventActions",value:function(e){this.eventHandlers.forEach((function(i,o){(o=t.htmlElementsToArray(o)).forEach((function(t){Object.keys(i).forEach((function(o){var r=i[o].handler;if("add"===e){var s=i[o].paramsOnAdd||[];t.addEventListener.apply(t,[o,r].concat(n(s)))}else if("remove"===e){var c=i[o].paramsOnRemove||[];t.removeEventListener.apply(t,[o,r].concat(n(c)))}}))}))}))}},{key:"initResizeObserverActions",value:function(e){this.resizeObserverInstances.forEach((function(i,n){(n=t.htmlElementsToArray(n)).forEach((function(t){"add"===e?i.observe(t):"remove"===e&&i.unobserve(t)}))}))}},{key:"windowScrollHandler",value:function(){this.setScrollDirection(),this.checkStickyPossibility()&&this.checkStickyScrolling()&&(this.checkTopInContainer()?(this.container.style.paddingBottom="","down"===this.scrollDirection&&this.setBottomStickyPosition()):this.checkBottomInContainer()?(this.container.style.paddingTop="","up"===this.scrollDirection&&this.setTopStickyPosition()):"up"===this.scrollDirection?"bottom"===this.stickyPosition&&(this.container.style.paddingBottom="".concat(this.container.clientHeight-(this.sidebar.offsetTop+this.sidebar.offsetHeight),"px"),this.container.style.paddingTop="",this.setTopStickyPosition()):"down"===this.scrollDirection&&"top"===this.stickyPosition&&(this.container.style.paddingTop="".concat(this.sidebar.offsetTop,"px"),this.container.style.paddingBottom="",this.setBottomStickyPosition()))}},{key:"sidebarResizeHandler",value:function(){this.update()}},{key:"containerResizeHandler",value:function(){this.update()}},{key:"stickyPositionCorrection",value:function(){var t=this.getTopStickyPosition(),e=this.getBottomStickyPosition(),i=this.sidebar.getBoundingClientRect().top-t>0,n=document.documentElement.clientHeight-e-this.sidebar.getBoundingClientRect().bottom>0;i?(this.removeContainerPaddings(),this.setTopStickyPosition()):n&&(this.removeContainerPaddings(),this.setBottomStickyPosition())}},{key:"update",value:function(){this.checkStickyPossibility()?this.checkStickyScrolling()?this.checkTopInContainer()?this.setTopStickyPosition():this.checkBottomInContainer()?this.setBottomStickyPosition():this.stickyPositionCorrection():(this.removeContainerPaddings(),this.setTopStickyPosition()):this.removeStickyPosition()}},{key:"checkTopInContainer",value:function(){return 0===this.sidebar.offsetTop}},{key:"checkBottomInContainer",value:function(){return this.sidebar.offsetTop+this.sidebar.offsetHeight===this.container.clientHeight}},{key:"checkStickyPossibility",value:function(){return this.container.clientHeight>this.sidebar.offsetHeight}},{key:"checkStickyScrolling",value:function(){var t=this.getTopStickyPosition(),e=this.getBottomStickyPosition(),i=document.documentElement.clientHeight-t-e;return this.sidebar.offsetHeight>i}},{key:"setTopStickyPosition",value:function(){this.container.classList.remove(this.stickyBottomClass),this.container.classList.add(this.stickyTopClass),this.stickyPosition="top"}},{key:"setBottomStickyPosition",value:function(){this.container.classList.remove(this.stickyTopClass),this.container.classList.add(this.stickyBottomClass),this.stickyPosition="bottom"}},{key:"removeStickyPosition",value:function(){this.removeContainerPaddings(),this.container.classList.remove(this.stickyTopClass,this.stickyBottomClass),this.stickyPosition=""}},{key:"removeContainerPaddings",value:function(){this.container.style.paddingTop="",this.container.style.paddingBottom=""}},{key:"setScrollDirection",value:function(){window.pageYOffset>this.currentScroll&&(this.scrollDirection="down"),window.pageYOffset<this.currentScroll&&(this.scrollDirection="up"),this.currentScroll=window.pageYOffset}},{key:"getTopStickyPosition",value:function(){return t.getStyleNumberValue(this.sidebar,"--top-position")}},{key:"getBottomStickyPosition",value:function(){return t.getStyleNumberValue(this.sidebar,"--bottom-position")}}],[{key:"getStyleNumberValue",value:function(t,e){return parseFloat(window.getComputedStyle(t).getPropertyValue(e))||0}},{key:"htmlElementsToArray",value:function(e){return"NodeList"===t.type(e)?n(e):[e]}},{key:"type",value:function(t){return Object.prototype.toString.call(t).match(/^\[object (\S+?)]$/)[1]||"undefined"}},{key:"debounce",value:function(t){var e;return function(){for(var i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];var r=this;e&&window.cancelAnimationFrame(e),e=window.requestAnimationFrame((function(){t.apply(r,n)}))}}}]),t}();e.default=h},function(t,e,i){}]).default}));